{"ast":null,"code":"import _asyncToGenerator from\"/Users/konstantin/Documents/Study/my-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _objectSpread from\"/Users/konstantin/Documents/Study/my-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/Users/konstantin/Documents/Study/my-app/node_modules/@babel/runtime/regenerator/index.js\";import{authAPI,profileAPI}from\"../../src/api/api\";import{stopSubmit}from\"redux-form\";var SET_USER_DATA='auth/SET-USER-DATA';var SET_MY_USER_DATA='auth/SET-MY-USER-DATA';var initialState={userId:null,email:null,login:null,myProfile:null,isAuth:false};var authReducer=function authReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case SET_USER_DATA:return _objectSpread(_objectSpread({},state),action.payload);case SET_MY_USER_DATA:return _objectSpread(_objectSpread({},state),{},{myProfile:action.data});default:return state;}};export var setAuthUserData=function setAuthUserData(userId,email,login,isAuth){return{type:SET_USER_DATA,payload:{userId:userId,email:email,login:login,isAuth:isAuth}};};export var setMyUserData=function setMyUserData(data){return{type:SET_MY_USER_DATA,data:data};};export var getAuthUserData=function getAuthUserData(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var data,_data$data,id,email,_login;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return authAPI.me();case 2:data=_context.sent;if(data.resultCode===0){_data$data=data.data,id=_data$data.id,email=_data$data.email,_login=_data$data.login;dispatch(setAuthUserData(id,email,_login,true));profileAPI.getProfile(id).then(function(data){dispatch(setMyUserData(data));});}case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var login=function login(email,password,rememberMe){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var data,message;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return authAPI.login(email,password,rememberMe);case 2:data=_context2.sent;if(data.resultCode===0){dispatch(getAuthUserData());}else{message=data.messages.length>0?data.messages[0]:'Some error';dispatch(stopSubmit('Login',{_error:message}));}case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var logout=function logout(email,password,rememberMe){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return authAPI.logout(email,password,rememberMe);case 2:data=_context3.sent;if(data.resultCode===0){dispatch(setAuthUserData(null,null,null,false));}case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export default authReducer;","map":{"version":3,"sources":["/Users/konstantin/Documents/Study/my-app/src/redux/auth-reducer.js"],"names":["authAPI","profileAPI","stopSubmit","SET_USER_DATA","SET_MY_USER_DATA","initialState","userId","email","login","myProfile","isAuth","authReducer","state","action","type","payload","data","setAuthUserData","setMyUserData","getAuthUserData","dispatch","me","resultCode","id","getProfile","then","password","rememberMe","message","messages","length","_error","logout"],"mappings":"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","sourcesContent":["import { authAPI, profileAPI } from \"../../src/api/api\";\nimport { stopSubmit } from \"redux-form\"\n\nconst SET_USER_DATA = 'auth/SET-USER-DATA';\nconst SET_MY_USER_DATA = 'auth/SET-MY-USER-DATA'\n\nlet initialState = {\n    userId: null,\n    email: null,\n    login: null,\n    myProfile: null,\n    isAuth: false,\n}\n\nconst authReducer = (state = initialState, action) => {\n    switch (action.type) {\n        case SET_USER_DATA:\n            return {\n                ...state,\n                ...action.payload,\n            }\n        case SET_MY_USER_DATA:\n            return {\n                ...state,\n                myProfile: action.data,\n            }\n        default:\n            return state;\n    }\n}\nexport const setAuthUserData = (userId, email, login, isAuth) => ({ type: SET_USER_DATA, payload: { userId, email, login, isAuth } });\nexport const setMyUserData = (data) => ({ type: SET_MY_USER_DATA, data })\n\nexport const getAuthUserData = () => async (dispatch) => {\n    let data = await authAPI.me();\n    if (data.resultCode === 0) {\n        let { id, email, login } = data.data;\n        dispatch(setAuthUserData(id, email, login, true));\n        profileAPI.getProfile(id).then(data => {\n            dispatch(setMyUserData(data));\n        })\n    }\n}\nexport const login = (email, password, rememberMe) => async (dispatch) => {\n    let data = await authAPI.login(email, password, rememberMe)\n    if (data.resultCode === 0) {\n        dispatch(getAuthUserData());\n    } else {\n        let message = data.messages.length > 0 ? data.messages[0] : 'Some error'\n        dispatch(stopSubmit('Login', { _error: message }))\n    }\n}\nexport const logout = (email, password, rememberMe) => async (dispatch) => {\n    let data = await authAPI.logout(email, password, rememberMe)\n    if (data.resultCode === 0) {\n        dispatch(setAuthUserData(null, null, null, false));\n    }\n}\n\nexport default authReducer;"]},"metadata":{},"sourceType":"module"}